		/*											*/	/*				Старые функции				*/	/*											*/		/*function getCookie(name) {	  var elem = "false";	  var matches = document.cookie.match(new RegExp(		"(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"	  ));	  return matches ? decodeURIComponent(matches[1]) : elem;	}	var date = new Date(new Date().getTime() + 600000 * 1000000);	function setCookie (name, value, date) {		document.cookie = name + "=" + value + "; path=/; expires=" + date.toUTCString();		return true;	}*/			/*											*/	/*					Тело					*/	/*											*/		if (document.querySelectorAll('.footer .choosers a')[1].innerHTML == "miped.ru") {		document.querySelectorAll('.mainProfileColumn .messageInfo').forEach(function(a) {			a.style.backgroundColor = "#fafafa";		});		document.querySelectorAll('.mainProfileColumn .messageInfo .secondaryContent').forEach(function(a) {			a.style.backgroundColor = "#f0f0f0";		});	}		if( location.href.match(/\/members\//) ) {		var c_main = document.querySelector('#uix_wrapper #headerMover').children;		for (i = 0; i < c_main.length - 1; i++) {			c_main[i].style.opacity = "0";			c_main[i].style.height = "0px";			c_main[i].style.overflow = "hidden";		}		var c_mast = document.querySelector('#uix_wrapper #headerMover .profilePage .mast');		c_mast.style.opacity = "0";		c_mast.style.height = "0px";		c_mast.style.overflow = "hidden";		var src = c_mast.querySelector('img').src;		var c_col = document.querySelector('#uix_wrapper #headerMover .profilePage .mainProfileColumn').style;		c_col.width = "800px";		c_col.margin = "0 auto";		var element = document.querySelector('.mainProfileColumn');		var lb = window.getComputedStyle(element, null).getPropertyValue('border-left');		element.style.borderRight = lb;		document.querySelectorAll('.messageSimpleList .messageSimple img').forEach(function(a) {			a.src = a.src.replace(/\/s\//, '/l/');		});	}		document.querySelectorAll('.pairsInlineplus img').forEach(function(a) {		a.src = chrome.extension.getURL('/img/reputation.png');	});			if( location.href.match(/\/anotherone/) ) { // профиль пользователя "AnotherOne"		document.body.style = "background: url(" + chrome.extension.getURL('/img/anotherone/r.jpg') + ")!important;";		document.querySelector('.pageContent.noBorderRadiusBottom').style = "background: rgba(0,0,0,0)!important; border: 0!important;";		document.querySelector('.mainProfileColumn').style.border = "0";		document.querySelector('.messageInfo').style.background = "rgba(50,50,50,.7)!important"		console.log('Открыт профиль пользователя "AnotherOne"');		var music = document.createElement('audio');		music.autoplay = "autoplay";		//music.volume = "0.1";		music.src = chrome.extension.getURL('/img/anotherone/r.mp3');		document.body.appendChild(music);	}		    /*document.querySelectorAll('.Tooltip.onlineMarker').forEach(function(a) {		a.style = 'border-top-width: 3px!important; border-bottom-width: 3px!important; border-left-width: 3px!important; border-right-width: 3px!important; '				+ 'border: 3px solid!important;';	});*/	document.body.style.opacity = "1";		var vk_content = "", twitch_content = "";	// получение страницы интерфейса выпадающего меню	fetch( chrome.extension.getURL('/html/interface.html') , { credentials: 'include' })	.then( function(response) { return response.text() })	.then( function(body) { 		var div = document.createElement('div');		div.setAttribute("id", "smile");		div.innerHTML = body;		document.body.insertBefore(div, document.body.firstChild);				// изначально необходимо создать куки (теперь ls), ибо если смайлы будут изначально выключены,		// как в прошлых версиях, то это будет провал		document.cookie = (!localStorage.getItem("vk")) ? localStorage.setItem("vk", "1") : console.log('Смайлы VK уже существуют');		document.cookie = (!localStorage.getItem("tw")) ? localStorage.setItem("tw", "1") : console.log('Смайлы TWITCH уже существуют');		document.cookie = (!localStorage.getItem("menu")) ? localStorage.setItem("menu", "1") : console.log('Меню активно');				// проверяем, активированы ли они		document.querySelector('input#vk').checked = ( localStorage.getItem("vk") == "1" ) ? true : false;		document.querySelector('input#tw').checked = ( localStorage.getItem("tw") == "1" ) ? true : false;		document.querySelector('input#menu').checked = ( localStorage.getItem("menu") == "0" ) ? true : false;		document.querySelector('img#nt').src = ( localStorage.getItem("menu") == "1" ) ? chrome.extension.getURL('/img/menu.png') : chrome.extension.getURL('/img/animenu.png');				var statusBar = document.querySelector('div#status');		var urll = "<br/><a class=\"ssll\" onclick=\"window.location.reload(); document.getElementsByClassName(\'ssll\')[0].innerHTML = \'Страница обновляется...\';\">Обновить страницу</a>";		// при изменении чекбокса присваиваем соответствующие куки		var thisElem = document.querySelector('input#vk');		thisElem.addEventListener('change', function() {			// document.cookie = (!getCookie("vk") || getCookie("vk") == 0) ? setCookie("vk", "1", date) : setCookie("vk", "0", date);			if (!localStorage.getItem("vk") || localStorage.getItem("vk") == "0") localStorage.setItem("vk", "1");			else localStorage.setItem("vk", "0");			statusBar.innerHTML = urll;		});		var thisElem = document.querySelector('input#tw');		thisElem.addEventListener('change', function() {			// document.cookie = (!getCookie("tw") || getCookie("tw") == 0) ? setCookie("tw", "1", date) : setCookie("tw", "0", date);			if (!localStorage.getItem("tw") || localStorage.getItem("tw") == "0") localStorage.setItem("tw", "1");			else localStorage.setItem("tw", "0");			statusBar.innerHTML = urll;		});		var thisElem = document.querySelector('input#menu');		thisElem.addEventListener('change', function() {			// document.cookie = (!getCookie("menu") || getCookie("menu") == 0) ? setCookie("menu", "1", date) : setCookie("menu", "0", date);			if (!localStorage.getItem("menu") || localStorage.getItem("menu") == "0") localStorage.setItem("menu", "1");			else localStorage.setItem("menu", "0");			statusBar.innerHTML = urll;		});				var target = document.querySelector('.redactor_box'), element;				fetch( chrome.extension.getURL("/txt/smiles.txt") )		.then( function(response) { return response.text() })		.then( function(body) {			if( localStorage.getItem("vk") == "1" ) {				vk_content = "<img src='" + chrome.extension.getURL('../img/vk.png') + "' style='vertical-align: middle;'>>"								var got = body;				var mas = got.match(/blockvk[a-zа-я0-9\:\/\.\-\_\r]*blockvk/ig)[0].replace(/blockvk/ig, '').split("\r");				console.log(">> " + body);				for(var i = 0; i < mas.length; i++) {					vk_content += "<li class='Smilie' data-text=''><img src='" + mas[i] + "' data-smilie='yes' style='vertical-align: middle;'></li>";				}				delete mas;			}			else {				vk_content = "<img src='" + chrome.extension.getURL('../img/vk_off.png') + "' style='vertical-align: middle;'>>";			}						if( localStorage.getItem("tw") == "1" ) {				twitch_content = "<img src='" + chrome.extension.getURL('../img/tw.png') + "' style='vertical-align: middle;'>"								got = body;				var mas2 = got.match(/blocktw[a-zа-я0-9\:\/\.\-\_\r]*blocktw/ig)[0].replace(/blocktw/ig, '').split("\r");				for(var i = 0; i < mas2.length; i++) {					twitch_content += "<li class='Smilie' data-text=''><img src='" + mas2[i] + "' data-smilie='yes' style='vertical-align: middle;'></li>";				}				delete mas2;			}			else {				twitch_content = "<img src='" + chrome.extension.getURL('../img/tw_off.png') + "' style='vertical-align: middle;'>>";			}						var observer = new MutationObserver(function(mutations) {				mutations.forEach(function(mutation) {					element = document.getElementsByClassName('redactor_smilies')[0];					if( element ) {						element.innerHTML = "<ul class='primaryContent smilieContainer' id='SmilieCategories1462645490'><li class='smilieCategory' style='display: list-item;'><ul><div class='line-height: 32px;'>"						+ vk_content						+ "</div><br/><div class='line-height: 32px;'>"						+ twitch_content						+ "</div></ul></li></ul>";					}				});    			});						var config = { attributes: true, childList: true, characterData: true };			observer.observe(target,  config);		});	});		/*											*/	/*					Титулы					*/	/*											*/		var elemA = document.querySelectorAll('.messageUserBlock');		elemA.forEach(function(a) {			if (a.querySelector('.Tooltip')) {				a.querySelector('.Tooltip').style.opacity = '0';				a.querySelector('.Tooltip').style.display = 'none';				a.querySelector('.avatar').style = 'box-shadow: 0 0 13px 1px rgba(63, 141, 98, 1);';			}			if (a.querySelector('.username[itemprop=name]')) {				if( a.querySelector('.username[itemprop=name]').innerHTML == "Aлександр" ) { 					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: #000; color: #FFF;";					div.innerHTML = "<span class='before'></span><strong>Создатель MipedSmiles</strong><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "AnotherOne" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/gay.png') + ");";					div.innerHTML = "<span class='before'></span>Генерал канавы<span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "Occultist" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/okkul.gif') + ");";					div.innerHTML = "<span class='before'></span><strong>ღ♥</strong><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "flnn_human" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/flnn2.gif') + ");";					div.innerHTML = "<span class='before'></span><div style='width: 5px; height: 16px;'></div><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "Lynxire" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/lunxire.png') + ");";					div.innerHTML = "<span class='before'></span><strong>Грибная богиня</strong><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "bold222" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/bold.jpg') + ");";					div.innerHTML = "<span class='before'></span><div style='width: 5px; height: 16px;'></div><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "_Trader Milk_" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/trader.gif') + ");";					div.innerHTML = "<span class='before'></span><strong>трапоняшка</strong><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "Dany1508" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/dany.jpg') + ");";					div.innerHTML = "<span class='before'></span><strong>ТОПОВЫЙ КУН</strong><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "Logequm" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/plash.gif') + ") center center;";					div.innerHTML = "<span class='before'></span><div style='width: 5px; height: 16px;'></div><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}				else if( a.querySelector('.username[itemprop=name]').innerHTML == "Negezor" ) {					var div = document.createElement('em');					div.className = "userBanner bannerStaff wrapped mipedCreator";					div.style = "background: url(" + chrome.extension.getURL('/img/negezor.gif') + ") center center;";					div.innerHTML = "<span class='before'></span><div style='width: 5px; height: 16px;'></div><span class='after'></span>";					a.querySelector('.userText').appendChild(div);				}			}		});	